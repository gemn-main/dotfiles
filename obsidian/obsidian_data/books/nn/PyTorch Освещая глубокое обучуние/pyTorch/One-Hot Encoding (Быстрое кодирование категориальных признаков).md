Как работает One-Hot Encoding?

Исходные данные:
  Допустим, есть признак "Цвет" с категориями: ["Красный", "Зеленый", "Синий"].

Преобразование:
    Каждая категория превращается в отдельный столбец:
        Красный → [1, 0, 0]
        Зеленый → [0, 1, 0]
        Синий → [0, 0, 1]


```python
target_onehot = torch.zeros(target.shape[0],10)
target_onehot.scatter_(1, target.unsqueeze(1), 1.0)
```

---

### **Шаг 1: Создаём нулевую матрицу для one-hot encoding**  
```python
target_onehot = torch.zeros(target.shape[0], 10)
```
- `target.shape[0]` — количество элементов в `target` (сколько у вас примеров).
- `10` — количество классов (в MNIST — 10 цифр).

**Результат**:  
Создаётся матрица размера `(N, 10)`, заполненная нулями.  
Пример для `N=5`:
```
[[0., 0., 0., 0., 0., 0., 0., 0., 0., 0.],
 [0., 0., 0., 0., 0., 0., 0., 0., 0., 0.],
 [0., 0., 0., 0., 0., 0., 0., 0., 0., 0.],
 [0., 0., 0., 0., 0., 0., 0., 0., 0., 0.],
 [0., 0., 0., 0., 0., 0., 0., 0., 0., 0.]]
```

---

### **Шаг 2: Преобразуем `target` в правильную форму**  
```python
target.unsqueeze(1)
```
- `unsqueeze(1)` добавляет новую размерность, превращая `[6, 6, 6, ..., 7, 6]` в `[[6], [6], [6], ..., [7], [6]]`.  
- Это нужно, потому что `scatter_` ожидает индекс в виде `(N, 1)`, а не `(N,)`.

**Пример**:  
Если `target = [6, 7, 6]`, то после `unsqueeze(1)` получим:
```
[[6],
 [7],
 [6]]
```

---

### **Шаг 3: Заполняем `target_onehot` единицами в нужных позициях**  
```python
target_onehot.scatter_(1, target.unsqueeze(1), 1.0)
```
- `scatter_(dim, index, value)` заполняет `target_onehot` значениями `1.0` по индексам из `target.unsqueeze(1)`.
- `dim=1` означает, что замена происходит вдоль второго измерения (столбцы).

**Как это работает**:  
Для каждой строки `i`:
1. Берётся значение `target[i]` (например, `6`).  
2. В строке `i` в столбце `6` ставится `1.0`.  

**Пример**:  
Пусть `target = [6, 7, 6]`, тогда:
```
Исходный target_onehot (3x10):
[[0., 0., 0., 0., 0., 0., 0., 0., 0., 0.],
 [0., 0., 0., 0., 0., 0., 0., 0., 0., 0.],
 [0., 0., 0., 0., 0., 0., 0., 0., 0., 0.]]

После scatter_:
[[0., 0., 0., 0., 0., 0., 1., 0., 0., 0.],  # 6-й столбец = 1
 [0., 0., 0., 0., 0., 0., 0., 1., 0., 0.],  # 7-й столбец = 1
 [0., 0., 0., 0., 0., 0., 1., 0., 0., 0.]]  # 6-й столбец = 1
```

---

### **Итоговый результат**  
Если `target = tensor([6, 6, 6, ..., 6, 7, 6])`, то `target_onehot` будет матрицей, где:
- В каждой строке стоит `1.0` в столбце, соответствующем классу из `target`.
- Остальные значения — `0.0`.

Пример для `target = [6, 7, 6]`:
```python
tensor([[0., 0., 0., 0., 0., 0., 1., 0., 0., 0.],
        [0., 0., 0., 0., 0., 0., 0., 1., 0., 0.],
        [0., 0., 0., 0., 0., 0., 1., 0., 0., 0.]])
```

---
